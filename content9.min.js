/* Copyright 2025 Securly, Inc. All rights reserved. */
var rproxPort=chrome.runtime.connect({name:"rproxport"});async function onRHWindowLoad(){let t=document.evaluate("//script",document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),e="",a=/\/static\/js\/main\.[0-9a-z]{1,}\.js/i;for(let n=0;n<t.snapshotLength;n++)if(t.snapshotItem(n).attributes.length>0&&null!=t.snapshotItem(n).attributes.src&&null!==t.snapshotItem(n).attributes.src.value.match(a)){e=t.snapshotItem(n).attributes.src.value;break}if(""!==e){let t=await fetch(e),a=await t.text();("9c6d270f3803b30049faad6927e9b0cd3c6325b3a00ec8a20303049f386add4b"==await sha256(a)||a.includes("M 21 13 h -8 v 8 h -3 v -8 H 2 v -3 h 8 V 2 h 3 v 8 h 8 Z"))&&sendRammerHeadData(window.location.href)}else{let t=document.evaluate("//input",document,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);for(let e=0;e<t.snapshotLength;e++)if(t.snapshotItem(e).attributes.length>0&&null!=t.snapshotItem(e).getAttribute("placeholder")&&"click on 'Create new session ID' or 'Fill in existing session ID' from below"==t.snapshotItem(e).getAttribute("placeholder")){sendRammerHeadData(window.location.href);break}}}async function sha256(t){const e=(new TextEncoder).encode(t),a=await window.crypto.subtle.digest("SHA-256",e);return Array.from(new Uint8Array(a)).map(t=>t.toString(16).padStart(2,"0")).join("")}function sendRammerHeadData(t){rproxPort.postMessage({action:"rprox",data:{url:window.location.href}})}function callWindowLoadWithTimeOut(){setTimeout(onRHWindowLoad,2e3)}window.addEventListener?window.addEventListener("load",callWindowLoadWithTimeOut,!1):window.attachEvent&&window.attachEvent("onload",callWindowLoadWithTimeOut);